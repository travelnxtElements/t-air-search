<script>
Eva = window.Eva || {};

/*
Air search api translator to build request object as per Mystique API and response is not modified, original is returned as is.

<b>Search criteria object model</b>

    {    
        adultCount: Number, //default: 1
        childCount: Number, //default: 0
        seniorCount: Number,//default: 0
        infantCount: Number,//default: 0
        adultAges: Array, //default: []
        childAges:  Array,//default: []
        seniorAges: Array,//default: []
        infantAges: Array,//default: []
        nonStopOnly: Boolean, //default: false
        cabinType: String, // Economy/Business/First, //default: Economy        
        leg1Origin: Location Object, //default: null  //required field     
        includeNearByAirportsForLeg1Origin: Boolean, //default: true
        leg1Destination: Location Object, //default: null //required field
        includeNearByAirportsForLeg1Destination: Boolean, //default: true
        leg1Date: String, //as per globalization format, //default: null  //required field     
        leg2Date: String, //as per globalization format, //default: null  //required field
        tripType: String, //RoundTrip/OneWay, //default: RoundTrip
    }

<b>Location object model</b>

    {
        type: String, //Airport/City, //default: Airport
        geoCode: String, //{Lat,Long} //default: null
        name: String, //default: null
        code: String, //default: null
    }

Note: `geoCode` AND `name` are optional in case `type` is `City`
@polymerBehavior 

*/
Eva.AirSearchAPITranslator = {
    /**
    * Constructs request object from given event args
    */
     buildRequest: function(data) {
        var request = {
            "Passengers": [{
                "quantity": data.adultCount || 1,
                "type": "Adult",
                "ages": data.adultAges || []
            }, {
                "quantity": data.childCount || 0,
                "type": "Child",
                "ages": data.childAges || []
            }, {
                "quantity": data.seniorCount || 0,
                "type": "Senior",
                "ages": data.seniorAges || []
            }, {
                "quantity": data.infantCount || 0,
                "type": "Infant",
                "ages": data.infantAges || []
            }],
            "legs": [{
                "departureLocation": data.leg1Origin,
                "includeNearByAirportsForDeparture": this._getValue(data.includeNearByAirportsForLeg1Origin, true),
                "arrivalLocation": data.leg1Destination,
                "includeNearByAirportsForArrival": this._getValue(data.includeNearByAirportsForLeg1Destination, true),
                "travelDate": {
                    "date": data.leg1Date
                }
            }],
            "productType": "Flight",
            "preferences": {
                "nonStopOnly": this._getValue(data.nonStopOnly, false),
                "cabinType": data.cabinType
            }
        };

        if (data.tripType.toLowerCase() === 'roundtrip') {
            request.legs.push({
                "departureLocation": data.leg1Destination,
                "includeNearByAirportsForDeparture": this._getValue(data.includeNearByAirportsForLeg1Destination, true),
                "arrivalLocation": data.leg1Origin,
                "includeNearByAirportsForArrival": this._getValue(data.includeNearByAirportsForLeg1Origin, true),
                "travelDate": {
                    "date": data.leg2Date
                }
            });
        }        
        return request;
    },

    /**
    * Constructs response object from given event args
    */
    buildResponse: function(data){
        return data;
    },

    _getValue: function(val, defVal){
        if(val!= null && val!= undefined)
            return val;
        return defVal;
    }
}
</script>
